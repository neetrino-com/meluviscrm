# üöÄ –ü–ª–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏)

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-20  
**–¶–µ–ª—å:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ API

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

**–ì–õ–ê–í–ù–û–ï –ü–†–ê–í–ò–õ–û:** 
- **–í–°–ï –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏!** 
- –ö–µ—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ö–µ—à –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∫–µ—à–∞: **60 —Å–µ–∫—É–Ω–¥ (1 –º–∏–Ω—É—Ç–∞)**
- –ü—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö (POST/PUT/DELETE) - **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à
- –ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ - –ª—É—á—à–µ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö > –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –∑–∞–ø—Ä–æ—Å–∞—Ö

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤–Ω–µ—à–Ω–∏–º API

**–í–Ω–µ—à–Ω–∏–µ API endpoints (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–Ω–µ—à–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π):**
- `GET /api/districts` ‚Üí `{ data: [...] }`
- `GET /api/districts/{id}/buildings` ‚Üí `{ data: [...] }`
- `GET /api/buildings/{id}/apartments` ‚Üí `{ data: { items: [...], pagination: {...} } }`
- `GET /api/external/apartments/{id}` ‚Üí –æ–±—ä–µ–∫—Ç –∫–≤–∞—Ä—Ç–∏—Ä—ã
- `PUT /api/apartments/{id}/status` ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `GET /api/districts-by-slug/{slug}/buildings`
- `GET /api/buildings-by-slug/{slug}/apartments`

**–ü—Ä–∞–≤–∏–ª–æ:** –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ù–ï –¥–æ–ª–∂–Ω—ã –º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ API!

---

## üìã –ó–∞–¥–∞—á–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (–°–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å)

#### 1. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ Prisma schema
**–ü–æ—á–µ–º—É:** –£—Å–∫–æ—Ä–∏—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ 5-10 —Ä–∞–∑, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è dashboard –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤  
**–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API:** ‚ùå –ù–ï–¢ (—Ç–æ–ª—å–∫–æ —É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã)

**–ó–∞–¥–∞—á–∏:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ `prisma/schema.prisma`:
  ```prisma
  model Apartment {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
    @@index([status])
    @@index([dealDate])
    @@index([buildingId, status])
  }
  ```
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `npx prisma migrate dev --name add_apartment_indexes`
- [ ] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ production

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `prisma/schema.prisma`

---

#### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å `dashboardService.getFinancialSummary()`
**–ü–æ—á–µ–º—É:** –°–µ–π—á–∞—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï –∫–≤–∞—Ä—Ç–∏—Ä—ã –≤ –ø–∞–º—è—Ç—å - –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ  
**–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API:** ‚ùå –ù–ï–¢ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π endpoint)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –¢–ï–ö–£–©–ò–ô –ö–û–î (–ø–ª–æ—Ö–æ):
const soldApartments = await prisma.apartment.findMany({
  where: { status: 'SOLD' },
  select: { totalPrice: true, totalPaid: true, ... }
});
// –ó–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï –∑–∞–ø–∏—Å–∏ –≤ –ø–∞–º—è—Ç—å!
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ù–û–í–´–ô –ö–û–î (—Ö–æ—Ä–æ—à–æ):
const soldAggregate = await prisma.apartment.aggregate({
  where: { status: 'SOLD' },
  _sum: { totalPrice: true, totalPaid: true },
  _count: { id: true }
});
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SQL –∞–≥—Ä–µ–≥–∞—Ü–∏—é, –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
```

**–ó–∞–¥–∞—á–∏:**
- [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `getFinancialSummary()` –∏—Å–ø–æ–ª—å–∑—É—è `aggregate` –≤–º–µ—Å—Ç–æ `findMany`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `services/dashboard.service.ts`

---

#### 3. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö API (–ù–ï –≤–Ω–µ—à–Ω–∏—Ö!)
**–ü–æ—á–µ–º—É:** Districts/buildings —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è, –Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è —á–∞—Å—Ç–æ  
**–í—Ä–µ–º—è:** 1-2 —á–∞—Å–∞  
**–†–∏—Å–∫ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API:** ‚ö†Ô∏è –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô (–µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** 
- **–í–°–ï –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏!**
- –ö–µ—à —Ç–æ–ª—å–∫–æ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î, –ù–ï –¥–ª—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ö–µ—à –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –û–ß–ï–ù–¨ –∫–æ—Ä–æ—Ç–∫–∏–º - –º–∞–∫—Å–∏–º—É–º 1-2 –º–∏–Ω—É—Ç—ã
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –ø—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

**–ü—Ä–∞–≤–∏–ª–æ:** 
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å: `/api/dashboard/*`, `/api/districts` (—Ç–æ–ª—å–∫–æ –¥–ª—è Session), `/api/buildings` (—Ç–æ–ª—å–∫–æ –¥–ª—è Session)
- ‚ùå –ù–ï –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å: –≤–Ω–µ—à–Ω–∏–µ API endpoints (—Å Bearer Token) - –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚ö†Ô∏è –ö–µ—à —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ù–ï –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–¥–∞—á–∏:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `@upstash/redis` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–µ—à Next.js
- [ ] –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è: `lib/cache.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à –¥–ª—è `/api/dashboard/summary` (30 —Å–µ–∫—É–Ω–¥) - –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π!
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à –¥–ª—è `/api/dashboard/financial` (30 —Å–µ–∫—É–Ω–¥) - –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π!
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à –¥–ª—è `/api/dashboard/timeline` (60 —Å–µ–∫—É–Ω–¥) - –º–∞–∫—Å–∏–º—É–º 1 –º–∏–Ω—É—Ç–∞!
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à –¥–ª—è `/api/districts` (—Ç–æ–ª—å–∫–æ –¥–ª—è Session, 60 —Å–µ–∫—É–Ω–¥) - –ù–ï 5 –º–∏–Ω—É—Ç!
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à –¥–ª—è `/api/buildings` (—Ç–æ–ª—å–∫–æ –¥–ª—è Session, 60 —Å–µ–∫—É–Ω–¥) - –ù–ï 5 –º–∏–Ω—É—Ç!
- [ ] **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö (POST/PUT/DELETE):
  - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ district ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à `districts`
  - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ building ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à `buildings` –∏ `districts`
  - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ apartment (—Å—Ç–∞—Ç—É—Å, —Ü–µ–Ω–∞, –æ–ø–ª–∞—Ç–∞) ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à:
    - `dashboard:summary`
    - `dashboard:financial`
    - `dashboard:timeline`
    - `apartments:*` (–µ—Å–ª–∏ –∫–µ—à–∏—Ä—É–µ—Ç—Å—è)
  
  **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
  ```typescript
  // –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è apartment
  await invalidateCache(['dashboard:summary', 'dashboard:financial', 'dashboard:timeline']);
  
  // –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è district
  await invalidateCache(['districts', 'buildings']);
  ```

**–í–∞–∂–Ω–æ:** 
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ Bearer Token - –µ—Å–ª–∏ –µ—Å—Ç—å, –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à
- –î–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ
- –ö–µ—à = –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ù–ï –∏—Å—Ç–æ—á–Ω–∏–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è - –ª—É—á—à–µ –ù–ï –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å, —á–µ–º –ø–æ–∫–∞–∑–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `lib/cache.ts` (—Å–æ–∑–¥–∞—Ç—å)
- `app/api/dashboard/summary/route.ts`
- `app/api/dashboard/financial/route.ts`
- `app/api/dashboard/timeline/route.ts`
- `app/api/districts/route.ts`
- `app/api/buildings/route.ts`

---

### üü° –í–ê–ñ–ù–û (–°–¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö)

#### 4. –î–æ–±–∞–≤–∏—Ç—å Rate Limiting
**–ü–æ—á–µ–º—É:** –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π –∏ –±–æ—Ç–æ–≤  
**–í—Ä–µ–º—è:** 1 —á–∞—Å  
**–†–∏—Å–∫ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API:** ‚ö†Ô∏è –°–†–ï–î–ù–ò–ô (–Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–º–∏—Ç—ã)

**–ü—Ä–∞–≤–∏–ª–æ:**
- –í–Ω–µ—à–Ω–∏–µ API: –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ –ª–∏–º–∏—Ç—ã (100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ API: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã (30 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
- Auth endpoints: —Å—Ç—Ä–æ–≥–∏–µ –ª–∏–º–∏—Ç—ã (5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)

**–ó–∞–¥–∞—á–∏:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `@upstash/ratelimit` –∏ `@upstash/redis`
- [ ] –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è rate limiting: `lib/rate-limit.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è `/api/auth/*` (5 req/min)
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è `/api/apartments` (30 req/min)
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è `/api/dashboard/*` (10 req/min)
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API (100 req/min) - –º—è–≥—á–µ!
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Upstash Redis –Ω–∞ Vercel

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `lib/rate-limit.ts` (—Å–æ–∑–¥–∞—Ç—å)
- `app/api/auth/[...nextauth]/route.ts`
- `app/api/apartments/route.ts`
- `app/api/dashboard/*/route.ts`
- –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ API endpoints

---

#### 5. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (next/image)
**–ü–æ—á–µ–º—É:** –£–º–µ–Ω—å—à–∏—Ç —Ä–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞ –∏ —É—Å–∫–æ—Ä–∏—Ç –∑–∞–≥—Ä—É–∑–∫—É  
**–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API:** ‚ùå –ù–ï–¢ (—Ç–æ–ª—å–∫–æ UI)

**–ó–∞–¥–∞—á–∏:**
- [ ] –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –æ–±—ã—á–Ω—ã–µ `<img>` –Ω–∞ `<Image>` –∏–∑ `next/image`
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ `next.config.js` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –î–æ–±–∞–≤–∏—Ç—å lazy loading –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `components/apartments/FileUpload.tsx`
- `components/apartments/ApartmentCard.tsx`
- `next.config.js`

---

### üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û (–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ)

#### 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
**–ü–æ—á–µ–º—É:** –ü–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞  
**–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç

**–ó–∞–¥–∞—á–∏:**
- [ ] –í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Prisma (—Ç–æ–ª—å–∫–æ –¥–ª—è dev/staging)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (>1 —Å–µ–∫—É–Ω–¥—ã)

---

#### 7. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
**–ü–æ—á–µ–º—É:** –î–ª—è –±—É–¥—É—â–∏—Ö –æ—Ç—á–µ—Ç–æ–≤/—ç–∫—Å–ø–æ—Ä—Ç–∞  
**–í—Ä–µ–º—è:** 1 —á–∞—Å

**–ó–∞–¥–∞—á–∏:**
- [ ] –ò–∑—É—á–∏—Ç—å Vercel Queue –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –æ—á–µ—Ä–µ–¥–µ–π
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- [ ] –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ Neon (–∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î):
- –ò–Ω–¥–µ–∫—Å—ã: **-30%** –∑–∞–ø—Ä–æ—Å–æ–≤ (—É—Å–∫–æ—Ä–µ–Ω–∏–µ)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è dashboard: **-80%** –∑–∞–ø—Ä–æ—Å–æ–≤ (aggregate –≤–º–µ—Å—Ç–æ findMany)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ dashboard: **-70%** –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–µ—à 30-60 —Å–µ–∫, –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π!)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ districts/buildings: **-50%** –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–µ—à 60 —Å–µ–∫, –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π!)

**–ò—Ç–æ–≥–æ: –æ–∂–∏–¥–∞–µ–º–∞—è —ç–∫–æ–Ω–æ–º–∏—è 50-70% –Ω–∞ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –ë–î**

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ö–µ—à –∫–æ—Ä–æ—Ç–∫–∏–π, –ø–æ—ç—Ç–æ–º—É —ç–∫–æ–Ω–æ–º–∏—è –º–µ–Ω—å—à–µ, –Ω–æ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ!

### –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- Dashboard –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ
- –°–ø–∏—Å–∫–∏ districts/buildings –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–∏–∑ –∫–µ—à–∞)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π (rate limiting)

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –í–Ω–µ—à–Ω–µ–µ API —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ 7 endpoints)
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ API –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- [ ] Rate limiting –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- [ ] –ö–µ—à –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –Ω–∞ production

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–Ω–µ—à–Ω–µ–µ API –Ω–µ —Å–ª–æ–º–∞–ª–æ—Å—å

```bash
# 1. Districts
curl -X GET "https://meluviscrm.vercel.app/api/districts" \
  -H "Authorization: Bearer YOUR_TOKEN" | jq '.'

# 2. Buildings by district
curl -X GET "https://meluviscrm.vercel.app/api/districts/1/buildings" \
  -H "Authorization: Bearer YOUR_TOKEN" | jq '.'

# 3. Apartments by building
curl -X GET "https://meluviscrm.vercel.app/api/buildings/1/apartments" \
  -H "Authorization: Bearer YOUR_TOKEN" | jq '.'

# 4. Apartment details
curl -X GET "https://meluviscrm.vercel.app/api/external/apartments/1" \
  -H "Authorization: Bearer YOUR_TOKEN" | jq '.'

# 5. Update status
curl -X PUT "https://meluviscrm.vercel.app/api/apartments/1/status" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"status": "available"}' | jq '.'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–∞–∫ –≤ `API-REQUESTS-BEARER-TOKEN-HY.md`

---

## üìù –ó–∞–º–µ—Ç–∫–∏

- **–í–°–ï –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏!** –ö–µ—à —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ö–µ—à –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–º (30-60 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º)
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –ø—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –í–Ω–µ—à–Ω–µ–µ API –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ –∫–µ—à–∞)
- Rate limiting –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º—è–≥—á–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging –ø–µ—Ä–µ–¥ production
- –ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö - –ª—É—á—à–µ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-20
